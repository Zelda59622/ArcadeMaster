<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arcade Master - Boutique</title>
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* STYLE SP√âCIFIQUE BOUTIQUE VERTICALE */
        
        /* Conteneur pour une cat√©gorie compl√®te */
        .category-container {
            margin-bottom: 40px;
            padding: 20px;
            border: 2px solid var(--color-neon-blue);
            border-radius: 10px;
            background-color: var(--color-background-dark);
            box-shadow: 0 0 10px var(--color-neon-blue);
        }

        .category-container h2 {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed var(--color-neon-blue);
            padding-bottom: 10px;
        }
        
        /* Conteneur pour les sous-cat√©gories (skins) */
        .subcategory-section {
            margin-top: 25px;
        }

        .subcategory-section h3 {
            color: var(--color-neon-orange);
            border-left: 5px solid var(--color-neon-orange);
            padding-left: 10px;
            margin-bottom: 15px;
        }

        /* Grid pour les items dans la sous-cat√©gorie */
        .skin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }
        
        .skin-item {
            background-color: #0d1a26;
            border: 1px solid var(--color-neon-green);
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .skin-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px var(--color-neon-green);
        }

        .skin-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="top-bar">...</div>
    <div id="sidebar" class="sidenav">...</div>

    <div class="main-container" id="mainContent">
        <div style="padding-top: 50px;"></div> 
        
        <h1 style="font-size: 2.5em; color: var(--color-neon-blue); text-align: center;">LE MARCH√â COSMIQUE</h1>
        <p style="text-align: center; color: var(--color-text-light); margin-bottom: 30px;">
            Personnalisez votre exp√©rience de jeu !
        </p>
        
        <div class="category-container">
            <h2 style="color: var(--color-neon-green);">üí∞ Achats Pi√®ces (Monnaie Premium)</h2>
            <div class="skin-grid store-grid">
                <div class="skin-item">
                    <img src="https://cdn-icons-png.flaticon.com/512/1000/1000727.png" alt="Pi√®ces" class="item-icon">
                    <h3>Pack D√©couverte</h3>
                    <p>10 Pi√®ces</p>
                    <button onclick="buyCoins('10 Coins')" class="btn-primary" style="background-color: var(--color-neon-red);">‚Ç¨2.99</button>
                </div>
                <div class="skin-item">
                    <img src="https://cdn-icons-png.flaticon.com/512/1000/1000732.png" alt="Pi√®ces" class="item-icon">
                    <h3>Pack Aventurier</h3>
                    <p>100 Pi√®ces</p>
                    <button onclick="buyCoins('100 Coins')" class="btn-primary" style="background-color: var(--color-neon-red);">‚Ç¨5.99</button>
                </div>
                <div class="skin-item">
                    <img src="https://cdn-icons-png.flaticon.com/512/1000/1000735.png" alt="Pi√®ces" class="item-icon">
                    <h3>Pack Galactique</h3>
                    <p>500 Pi√®ces</p>
                    <button onclick="buyCoins('500 Coins')" class="btn-primary" style="background-color: var(--color-neon-red);">‚Ç¨19.99</button>
                </div>
                <div class="skin-item">
                    <img src="https://cdn-icons-png.flaticon.com/512/1000/1000742.png" alt="Pi√®ces" class="item-icon">
                    <h3>Pack Ma√Ætre</h3>
                    <p>1500 Pi√®ces</p>
                    <button onclick="buyCoins('1500 Coins')" class="btn-primary" style="background-color: var(--color-neon-red);">‚Ç¨39.99</button>
                </div>
            </div>
        </div>

        <div class="category-container">
            <h2 style="color: var(--color-neon-orange);">üåå Space Invaders</h2>
            
            <div id="spaceInvadersSkins">
                </div>
        </div>
        
        <div class="category-container">
            <h2 style="color: var(--color-neon-green);">üêç Snake Infini</h2>
            
            <div id="snakeSkins">
                </div>
        </div>
        
    </div>

    <script src="base.js"></script>
    <script src="auth.js"></script>
    <script>
        // --- LOGIQUE DE LA BOUTIQUE (JS) ---

        // Donn√©es des skins (Ajout de skins ennemis et pour Snake)
        const SKINS_DATA = {
            spaceInvaders: {
                ship: [
                    { id: 100, name: "Classique", symbol: "üöÄ", price: 0, category: 'ship' },
                    { id: 101, name: "Aigle", symbol: "ü¶Ö", price: 50, category: 'ship' },
                    { id: 102, name: "Vip√®re", symbol: "üêç", price: 150, category: 'ship' },
                    { id: 103, name: "Soucoupe", symbol: "üõ∏", price: 500, category: 'ship' },
                ],
                invader: [
                    { id: 200, name: "Classique", symbol: "üëæ", price: 0, category: 'invader' },
                    { id: 201, name: "Yeux Rouges", symbol: "üëπ", price: 100, category: 'invader' },
                    { id: 202, name: "Robot Jaune", symbol: "ü§ñ", price: 300, category: 'invader' },
                ]
            },
            snakeInfini: {
                snake_head: [
                    { id: 300, name: "T√™te Verte", symbol: "üü¢", price: 0, category: 'snake_head' },
                    { id: 301, name: "T√™te Bleue", symbol: "üîµ", price: 50, category: 'snake_head' },
                    { id: 302, name: "T√™te Flamme", symbol: "üî•", price: 200, category: 'snake_head' },
                ],
                food: [
                    { id: 400, name: "Pomme", symbol: "üçé", price: 0, category: 'food' },
                    { id: 401, name: "Diamant", symbol: "üíé", price: 100, category: 'food' },
                    { id: 402, name: "G√¢teau", symbol: "üéÇ", price: 400, category: 'food' },
                ]
            }
        };

        // Liste simplifi√©e des skins poss√©d√©s pour le mode local
        let ownedSkins = {
            ship: [100], invader: [200], snake_head: [300], food: [400]
        };
        let activeSkins = {
            ship: 'üöÄ', invader: 'üëæ', snake_head: 'üü¢', food: 'üçé'
        };


        // Simule l'achat (affichage d'une alerte et mise √† jour de l'affichage)
        function buySkin(game, category, skinId, price) {
            const skin = SKINS_DATA[game][category].find(s => s.id === skinId);
            const user = typeof getCurrentUser === 'function' ? getCurrentUser() : null;

            if (user) {
                 // Si on a un utilisateur, on simule la v√©rification du prix
                 if (user.coins >= price) {
                      alert(`ACHAT R√âUSSI ! Le skin ${skin.name} est √† vous !`);
                      // Logique r√©elle d'ajout du skin et de d√©duction des pi√®ces...
                      
                      // Pour l'instant, on se contente de l'alerte
                      
                 } else {
                      alert(`Achat impossible : Il vous manque ${price - user.coins} pi√®ces !`);
                 }
            } else {
                 alert(`Achat non disponible : Vous n'√™tes pas connect√©. Le prix de ${skin.name} est de ${price} pi√®ces.`);
            }
        }
        
        // Simule l'√©quipement d'un skin
        function equipSkin(game, category, symbol) {
            alert(`Skin √©quip√© : ${symbol}`);
            // En mode local, cela devrait √™tre g√©r√© par l'outil Admin/auth.js
            
            // Met √† jour la variable locale pour le top bar
            if (category === 'ship') {
                 activeSkins.ship = symbol;
            }
            if (typeof updateTopBar === 'function') {
                updateTopBar();
            }
        }
        
        // Rend le bouton HTML
        function createButton(skin, game, category) {
             const user = typeof getCurrentUser === 'function' ? getCurrentUser() : null;
             
             // Simuler si le skin est poss√©d√© (simplifi√© pour le mode local)
             const isOwned = ownedSkins[category] && ownedSkins[category].includes(skin.id);

             if (isOwned) {
                const equipBtn = document.createElement('button');
                equipBtn.className = 'btn-primary';
                equipBtn.textContent = '√âquiper';
                equipBtn.style.backgroundColor = 'var(--color-neon-green)';
                equipBtn.onclick = () => equipSkin(game, category, skin.symbol);
                return equipBtn;
             } else {
                const buyBtn = document.createElement('button');
                buyBtn.className = 'btn-primary';
                buyBtn.textContent = `Acheter (${skin.price} üí∞)`;
                buyBtn.style.backgroundColor = 'var(--color-neon-blue)';
                buyBtn.onclick = () => buySkin(game, category, skin.id, skin.price);
                return buyBtn;
             }
        }
        
        // G√©n√®re le HTML pour une sous-cat√©gorie (Vaisseau, Monstre, etc.)
        function renderSubCategory(containerId, game, categoryKey, categoryTitle) {
            const skins = SKINS_DATA[game][categoryKey];
            const container = document.getElementById(containerId);
            
            const section = document.createElement('div');
            section.className = 'subcategory-section';
            
            section.innerHTML = `<h3>${categoryTitle}</h3>`;
            
            const grid = document.createElement('div');
            grid.className = 'skin-grid';

            skins.forEach(skin => {
                const item = document.createElement('div');
                item.className = 'skin-item';
                
                const icon = document.createElement('div');
                icon.className = 'skin-icon';
                icon.textContent = skin.symbol;
                item.appendChild(icon);
                
                const title = document.createElement('h4');
                title.textContent = skin.name;
                item.appendChild(title);
                
                item.appendChild(createButton(skin, game, categoryKey));
                grid.appendChild(item);
            });
            
            section.appendChild(grid);
            container.appendChild(section);
        }
        
        function renderAllSkins() {
            // Rendu Space Invaders
            renderSubCategory('spaceInvadersSkins', 'spaceInvaders', 'ship', 'Vaisseaux üöÄ');
            renderSubCategory('spaceInvadersSkins', 'spaceInvaders', 'invader', 'Monstres üëæ');

            // Rendu Snake Infini
            renderSubCategory('snakeSkins', 'snakeInfini', 'snake_head', 'T√™tes de Serpent üêç');
            renderSubCategory('snakeSkins', 'snakeInfini', 'food', 'Nourriture üçé');
        }


        // G√®re l'achat des pi√®ces (Rickroll)
        window.buyCoins = function(pack) {
            alert(`Vous avez tent√© d'acheter le ${pack}. La transaction est en cours...`);
            window.location.href = "https://www.youtube.com/watch?v=dQw4w9WgXcQ"; 
        }

        document.addEventListener('DOMContentLoaded', () => {
            if (typeof updateTopBar === 'function') {
                updateTopBar();
            }
            renderAllSkins(); 
        });
    </script>
</body>
</html>
